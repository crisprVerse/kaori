<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::SegmentedMismatches&lt; num_segments_ &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacekaori.html">kaori</a></li><li class="navelem"><a class="el" href="classkaori_1_1SegmentedMismatches.html">SegmentedMismatches</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1SegmentedMismatches-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::SegmentedMismatches&lt; num_segments_ &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Search for barcodes with segmented mismatches.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MismatchTrie_8hpp_source.html">MismatchTrie.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1SegmentedMismatches_1_1Result.html">Result</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structkaori_1_1SegmentedMismatches_1_1Result.html" title="Result of the segmented search.">Result</a> of the segmented search.  <a href="structkaori_1_1SegmentedMismatches_1_1Result.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aea8805326b85893900811ea787a736a2" id="r_aea8805326b85893900811ea787a736a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea8805326b85893900811ea787a736a2">SegmentedMismatches</a> ()=default</td></tr>
<tr class="separator:aea8805326b85893900811ea787a736a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebd37af784c3ec96feed22604af2abd1" id="r_aebd37af784c3ec96feed22604af2abd1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aebd37af784c3ec96feed22604af2abd1">SegmentedMismatches</a> (std::array&lt; SeqLength, num_segments_ &gt; segments, DuplicateAction duplicates)</td></tr>
<tr class="separator:aebd37af784c3ec96feed22604af2abd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ff582c52b24b9cb324f15dd3350f4ac" id="r_a8ff582c52b24b9cb324f15dd3350f4ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1TrieAddStatus.html">TrieAddStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ff582c52b24b9cb324f15dd3350f4ac">add</a> (const char *barcode_seq)</td></tr>
<tr class="separator:a8ff582c52b24b9cb324f15dd3350f4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e04e52ee793bce348a96f55596026d6" id="r_a1e04e52ee793bce348a96f55596026d6"><td class="memItemLeft" align="right" valign="top">SeqLength&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e04e52ee793bce348a96f55596026d6">length</a> () const</td></tr>
<tr class="separator:a1e04e52ee793bce348a96f55596026d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed489ff409742d48ba3ba5f432b40d8" id="r_a0ed489ff409742d48ba3ba5f432b40d8"><td class="memItemLeft" align="right" valign="top">BarcodeIndex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ed489ff409742d48ba3ba5f432b40d8">size</a> () const</td></tr>
<tr class="separator:a0ed489ff409742d48ba3ba5f432b40d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee67bf4e7e23772df930cfe4ccd07904" id="r_aee67bf4e7e23772df930cfe4ccd07904"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee67bf4e7e23772df930cfe4ccd07904">optimize</a> ()</td></tr>
<tr class="separator:aee67bf4e7e23772df930cfe4ccd07904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0fcf78739ef942b70cfb715144a24e4" id="r_af0fcf78739ef942b70cfb715144a24e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1SegmentedMismatches_1_1Result.html">Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af0fcf78739ef942b70cfb715144a24e4">search</a> (const char *search_seq, const std::array&lt; int, num_segments_ &gt; &amp;max_mismatches) const</td></tr>
<tr class="separator:af0fcf78739ef942b70cfb715144a24e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;int num_segments_&gt;<br />
class kaori::SegmentedMismatches&lt; num_segments_ &gt;</div><p>Search for barcodes with segmented mismatches. </p>
<p>Given a (typically read-derived) sequence, this class will perform a mismatch-aware search to a pool of known barcode sequences. However, the distribution of mismatches is restricted in different segments of the sequence, e.g., 1 mismatch in the first 4 bp, 3 mismatches for the next 10 bp, and so on. The aim is to enable searching for concatenations of variable region sequences (and barcodes), where each segment is subject to a different number of mismatches. The barcode with the fewest mismatches to the input sequence is then returned.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">num_segments_</td><td>Number of segments to consider. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aea8805326b85893900811ea787a736a2" name="aea8805326b85893900811ea787a736a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea8805326b85893900811ea787a736a2">&#9670;&#160;</a></span>SegmentedMismatches() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_segments_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1SegmentedMismatches.html">kaori::SegmentedMismatches</a>&lt; num_segments_ &gt;::SegmentedMismatches </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default constructor. This is only provided to enable composition, the resulting object should not be used until it is copy-assigned to a properly constructed instance. </p>

</div>
</div>
<a id="aebd37af784c3ec96feed22604af2abd1" name="aebd37af784c3ec96feed22604af2abd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebd37af784c3ec96feed22604af2abd1">&#9670;&#160;</a></span>SegmentedMismatches() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_segments_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1SegmentedMismatches.html">kaori::SegmentedMismatches</a>&lt; num_segments_ &gt;::SegmentedMismatches </td>
          <td>(</td>
          <td class="paramtype">std::array&lt; SeqLength, num_segments_ &gt;</td>          <td class="paramname"><span class="paramname"><em>segments</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DuplicateAction</td>          <td class="paramname"><span class="paramname"><em>duplicates</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">segments</td><td>Length of each segment of the sequence. Each entry should be positive and the sum should be equal to the total length of the barcode sequence. </td></tr>
    <tr><td class="paramname">duplicates</td><td>How duplicate sequences across <code><a class="el" href="#a8ff582c52b24b9cb324f15dd3350f4ac">add()</a></code> calls should be handled. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8ff582c52b24b9cb324f15dd3350f4ac" name="a8ff582c52b24b9cb324f15dd3350f4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ff582c52b24b9cb324f15dd3350f4ac">&#9670;&#160;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_segments_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1TrieAddStatus.html">TrieAddStatus</a> <a class="el" href="classkaori_1_1SegmentedMismatches.html">kaori::SegmentedMismatches</a>&lt; num_segments_ &gt;::add </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>barcode_seq</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">barcode_seq</td><td>Pointer to a character array containing a barcode sequence. The array should have length equal to <code><a class="el" href="#a1e04e52ee793bce348a96f55596026d6">length()</a></code> and should only contain IUPAC nucleotides or their lower-case equivalents (excepting U or gap characters).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The barcode sequence is added to the trie. The index of the newly added sequence is defined as the number of sequences that were previously added. The status of the addition is returned. </dd></dl>

</div>
</div>
<a id="a1e04e52ee793bce348a96f55596026d6" name="a1e04e52ee793bce348a96f55596026d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e04e52ee793bce348a96f55596026d6">&#9670;&#160;</a></span>length()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_segments_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SeqLength <a class="el" href="classkaori_1_1SegmentedMismatches.html">kaori::SegmentedMismatches</a>&lt; num_segments_ &gt;::length </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The length of the barcode sequences. </dd></dl>

</div>
</div>
<a id="aee67bf4e7e23772df930cfe4ccd07904" name="aee67bf4e7e23772df930cfe4ccd07904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee67bf4e7e23772df930cfe4ccd07904">&#9670;&#160;</a></span>optimize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_segments_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkaori_1_1SegmentedMismatches.html">kaori::SegmentedMismatches</a>&lt; num_segments_ &gt;::optimize </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attempt to optimize the trie for more cache-friendly look-ups. This is not necessary if sorted sequences are supplied in <code><a class="el" href="#a8ff582c52b24b9cb324f15dd3350f4ac">add()</a></code>. </p>

</div>
</div>
<a id="af0fcf78739ef942b70cfb715144a24e4" name="af0fcf78739ef942b70cfb715144a24e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0fcf78739ef942b70cfb715144a24e4">&#9670;&#160;</a></span>search()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_segments_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1SegmentedMismatches_1_1Result.html">Result</a> <a class="el" href="classkaori_1_1SegmentedMismatches.html">kaori::SegmentedMismatches</a>&lt; num_segments_ &gt;::search </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>search_seq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; int, num_segments_ &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>max_mismatches</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">search_seq</td><td>Pointer to a character array containing a sequence to use for searching the barcode pool. This is assumed to be of length equal to <code><a class="el" href="#a1e04e52ee793bce348a96f55596026d6">length()</a></code> and is typically derived from a read. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_mismatches</td><td>Maximum number of mismatches for each segment. Each entry should be non-negative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structkaori_1_1SegmentedMismatches_1_1Result.html" title="Result of the segmented search.">Result</a> of the search, containing the index of the matching barcode and the number of mismatches to that barcode. </dd></dl>

</div>
</div>
<a id="a0ed489ff409742d48ba3ba5f432b40d8" name="a0ed489ff409742d48ba3ba5f432b40d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed489ff409742d48ba3ba5f432b40d8">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int num_segments_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">BarcodeIndex <a class="el" href="classkaori_1_1SegmentedMismatches.html">kaori::SegmentedMismatches</a>&lt; num_segments_ &gt;::size </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of barcode sequences added. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/<a class="el" href="MismatchTrie_8hpp_source.html">MismatchTrie.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
