<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::SegmentedBarcodeSearch&lt; num_segments &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacekaori.html">kaori</a></li><li class="navelem"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html">SegmentedBarcodeSearch</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1SegmentedBarcodeSearch-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::SegmentedBarcodeSearch&lt; num_segments &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Search for known barcode sequences with segmented mismatches.  
 <a href="classkaori_1_1SegmentedBarcodeSearch.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="BarcodeSearch_8hpp_source.html">BarcodeSearch.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1Options.html">Options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optional parameters for a <code><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html" title="Search for known barcode sequences with segmented mismatches.">SegmentedBarcodeSearch</a></code>.  <a href="structkaori_1_1SegmentedBarcodeSearch_1_1Options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html" title="State of the search.">State</a> of the search.  <a href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1bb8a093dea8b7cf60248bca5ed59547" id="r_a1bb8a093dea8b7cf60248bca5ed59547"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a1bb8a093dea8b7cf60248bca5ed59547">SegmentedBarcodeSearch</a> ()</td></tr>
<tr class="separator:a1bb8a093dea8b7cf60248bca5ed59547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d39b38410748d98e2d56387ba67d11c" id="r_a6d39b38410748d98e2d56387ba67d11c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a6d39b38410748d98e2d56387ba67d11c">SegmentedBarcodeSearch</a> (const <a class="el" href="structkaori_1_1BarcodePool.html">BarcodePool</a> &amp;barcode_pool, std::array&lt; int, num_segments &gt; segments, const <a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a6d39b38410748d98e2d56387ba67d11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a0476dc43a7ae3006fb961e2e70639a" id="r_a6a0476dc43a7ae3006fb961e2e70639a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a6a0476dc43a7ae3006fb961e2e70639a">initialize</a> () const</td></tr>
<tr class="separator:a6a0476dc43a7ae3006fb961e2e70639a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1494ea1af5173c48d52313ed278ba7f6" id="r_a1494ea1af5173c48d52313ed278ba7f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a1494ea1af5173c48d52313ed278ba7f6">reduce</a> (<a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a> &amp;state)</td></tr>
<tr class="separator:a1494ea1af5173c48d52313ed278ba7f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38064ff8bee88d6031acb925be576bc6" id="r_a38064ff8bee88d6031acb925be576bc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a38064ff8bee88d6031acb925be576bc6">search</a> (const std::string &amp;search_seq, <a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a> &amp;state) const</td></tr>
<tr class="separator:a38064ff8bee88d6031acb925be576bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7830bbf5d48b4fadbe1b5fc57510559" id="r_af7830bbf5d48b4fadbe1b5fc57510559"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#af7830bbf5d48b4fadbe1b5fc57510559">search</a> (const std::string &amp;search_seq, <a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a> &amp;state, std::array&lt; int, num_segments &gt; allowed_mismatches) const</td></tr>
<tr class="separator:af7830bbf5d48b4fadbe1b5fc57510559"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;size_t num_segments&gt;<br />
class kaori::SegmentedBarcodeSearch&lt; num_segments &gt;</div><p>Search for known barcode sequences with segmented mismatches. </p>
<p>This supports exact and mismatch-aware searches for known sequences. Mismatches are restricted by segments along the sequence, see <code><a class="el" href="classkaori_1_1SegmentedMismatches.html" title="Search for barcodes with segmented mismatches.">SegmentedMismatches</a></code> for details. Instances of this class use caching to avoid redundant work when a mismatching sequence has been previously encountered.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">num_segments</td><td>Number of segments to consider. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1bb8a093dea8b7cf60248bca5ed59547" name="a1bb8a093dea8b7cf60248bca5ed59547"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bb8a093dea8b7cf60248bca5ed59547">&#9670;&#160;</a></span>SegmentedBarcodeSearch() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html">kaori::SegmentedBarcodeSearch</a>&lt; num_segments &gt;::SegmentedBarcodeSearch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default constructor. </p>

</div>
</div>
<a id="a6d39b38410748d98e2d56387ba67d11c" name="a6d39b38410748d98e2d56387ba67d11c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d39b38410748d98e2d56387ba67d11c">&#9670;&#160;</a></span>SegmentedBarcodeSearch() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html">kaori::SegmentedBarcodeSearch</a>&lt; num_segments &gt;::SegmentedBarcodeSearch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaori_1_1BarcodePool.html">BarcodePool</a> &amp;&#160;</td>
          <td class="paramname"><em>barcode_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; int, num_segments &gt;&#160;</td>
          <td class="paramname"><em>segments</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">barcode_pool</td><td>Pool of barcode sequences. </td></tr>
    <tr><td class="paramname">segments</td><td>Size of each segment. All values should be positive and their sum should be equal to the barcode length. </td></tr>
    <tr><td class="paramname">options</td><td>Optional parameters. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6a0476dc43a7ae3006fb961e2e70639a" name="a6a0476dc43a7ae3006fb961e2e70639a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a0476dc43a7ae3006fb961e2e70639a">&#9670;&#160;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a> <a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html">kaori::SegmentedBarcodeSearch</a>&lt; num_segments &gt;::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the search state for thread-safe execution.</p>
<dl class="section return"><dt>Returns</dt><dd>A new <code>SeachState()</code>. </dd></dl>

</div>
</div>
<a id="a1494ea1af5173c48d52313ed278ba7f6" name="a1494ea1af5173c48d52313ed278ba7f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1494ea1af5173c48d52313ed278ba7f6">&#9670;&#160;</a></span>reduce()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html">kaori::SegmentedBarcodeSearch</a>&lt; num_segments &gt;::reduce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Incorporate the mismatch cache from <code>state</code> into the cache for this <code><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html" title="Search for known barcode sequences.">SimpleBarcodeSearch</a></code> instance. This allows regular consolidation of optimizations across threads. On return, the mismatch cache of <code>state</code> is combined with that of this instance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>A state object generated by <code><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a6a0476dc43a7ae3006fb961e2e70639a">initialize()</a></code>. Typically this has already been used in <code><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a38064ff8bee88d6031acb925be576bc6">search()</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a38064ff8bee88d6031acb925be576bc6" name="a38064ff8bee88d6031acb925be576bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38064ff8bee88d6031acb925be576bc6">&#9670;&#160;</a></span>search() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html">kaori::SegmentedBarcodeSearch</a>&lt; num_segments &gt;::search </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>search_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Search the known sequences in the barcode pool for an input sequence. The number of allowed mismatches in each segment is equal to the maximum specified in the constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">search_seq</td><td>The input sequence to use for searching. This is expected to have the same length as the known sequences. </td></tr>
    <tr><td class="paramname">state</td><td>A state object generated by <code><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a6a0476dc43a7ae3006fb961e2e70639a">initialize()</a></code>. On return, <code>state</code> is filled with the details of the best-matching barcode sequence, if any exists. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af7830bbf5d48b4fadbe1b5fc57510559" name="af7830bbf5d48b4fadbe1b5fc57510559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7830bbf5d48b4fadbe1b5fc57510559">&#9670;&#160;</a></span>search() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html">kaori::SegmentedBarcodeSearch</a>&lt; num_segments &gt;::search </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>search_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaori_1_1SegmentedBarcodeSearch_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; int, num_segments &gt;&#160;</td>
          <td class="paramname"><em>allowed_mismatches</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Search the known sequences in the barcode pool for an input sequence, with potentially more stringent mismatch requirements for each segment. This can improve efficiency in situations where some mismatches have already been consumed by matching the template sequence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">search_seq</td><td>The input sequence to use for searching. This is expected to have the same length as the known sequences. </td></tr>
    <tr><td class="paramname">state</td><td>A state object generated by <code><a class="el" href="classkaori_1_1SegmentedBarcodeSearch.html#a6a0476dc43a7ae3006fb961e2e70639a">initialize()</a></code>. On return, <code>state</code> is filled with the details of the best-matching barcode sequence, if any exists. </td></tr>
    <tr><td class="paramname">allowed_mismatches</td><td>Allowed number of mismatches in each segment. Each value should not be greater than the corresponding maximum specified in the constructor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/<a class="el" href="BarcodeSearch_8hpp_source.html">BarcodeSearch.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
