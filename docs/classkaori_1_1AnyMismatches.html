<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::AnyMismatches Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacekaori.html">kaori</a></li><li class="navelem"><a class="el" href="classkaori_1_1AnyMismatches.html">AnyMismatches</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1AnyMismatches-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::AnyMismatches Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Search for barcodes with mismatches anywhere.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MismatchTrie_8hpp_source.html">MismatchTrie.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1AnyMismatches_1_1Result.html">Result</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structkaori_1_1AnyMismatches_1_1Result.html" title="Result of the search.">Result</a> of the search.  <a href="structkaori_1_1AnyMismatches_1_1Result.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5c55208169863ad90143c4da8c15f40c" id="r_a5c55208169863ad90143c4da8c15f40c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c55208169863ad90143c4da8c15f40c">AnyMismatches</a> ()=default</td></tr>
<tr class="separator:a5c55208169863ad90143c4da8c15f40c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed3f2664b9141b3a2616cdda00fe786" id="r_a9ed3f2664b9141b3a2616cdda00fe786"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ed3f2664b9141b3a2616cdda00fe786">AnyMismatches</a> (SeqLength barcode_length, DuplicateAction duplicates)</td></tr>
<tr class="separator:a9ed3f2664b9141b3a2616cdda00fe786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf13ba52a8d43ef7125dcbadbba2cb3" id="r_abcf13ba52a8d43ef7125dcbadbba2cb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1TrieAddStatus.html">TrieAddStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abcf13ba52a8d43ef7125dcbadbba2cb3">add</a> (const char *barcode_seq)</td></tr>
<tr class="separator:abcf13ba52a8d43ef7125dcbadbba2cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91c7115078ceeccaeca40b5ef38c301d" id="r_a91c7115078ceeccaeca40b5ef38c301d"><td class="memItemLeft" align="right" valign="top">SeqLength&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91c7115078ceeccaeca40b5ef38c301d">length</a> () const</td></tr>
<tr class="separator:a91c7115078ceeccaeca40b5ef38c301d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5048fb2195f0ac6f9afb8e35eb9ede" id="r_a0b5048fb2195f0ac6f9afb8e35eb9ede"><td class="memItemLeft" align="right" valign="top">BarcodeIndex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b5048fb2195f0ac6f9afb8e35eb9ede">size</a> () const</td></tr>
<tr class="separator:a0b5048fb2195f0ac6f9afb8e35eb9ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a665ff85106cdd14d8f3ca6bb84feac9c" id="r_a665ff85106cdd14d8f3ca6bb84feac9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a665ff85106cdd14d8f3ca6bb84feac9c">optimize</a> ()</td></tr>
<tr class="separator:a665ff85106cdd14d8f3ca6bb84feac9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3743e50603f631c3c266b990f0a18000" id="r_a3743e50603f631c3c266b990f0a18000"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1AnyMismatches_1_1Result.html">Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3743e50603f631c3c266b990f0a18000">search</a> (const char *search_seq, int max_mismatches) const</td></tr>
<tr class="separator:a3743e50603f631c3c266b990f0a18000"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Search for barcodes with mismatches anywhere. </p>
<p>Given a (typically read-derived) sequence, this class performs a mismatch-aware search to a trie containing a pool of known barcode sequences. It will then return the barcode with the fewest mismatches to the input sequence. Any number of mismatches are supported, distributed anywhere throughout the sequence. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5c55208169863ad90143c4da8c15f40c" name="a5c55208169863ad90143c4da8c15f40c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c55208169863ad90143c4da8c15f40c">&#9670;&#160;</a></span>AnyMismatches() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kaori::AnyMismatches::AnyMismatches </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default constructor. This is only provided to enable composition, the resulting object should not be used until it is copy-assigned to a properly constructed instance. </p>

</div>
</div>
<a id="a9ed3f2664b9141b3a2616cdda00fe786" name="a9ed3f2664b9141b3a2616cdda00fe786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed3f2664b9141b3a2616cdda00fe786">&#9670;&#160;</a></span>AnyMismatches() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kaori::AnyMismatches::AnyMismatches </td>
          <td>(</td>
          <td class="paramtype">SeqLength</td>          <td class="paramname"><span class="paramname"><em>barcode_length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DuplicateAction</td>          <td class="paramname"><span class="paramname"><em>duplicates</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">barcode_length</td><td>Length of the barcode sequences. </td></tr>
    <tr><td class="paramname">duplicates</td><td>How duplicate sequences across <code><a class="el" href="#abcf13ba52a8d43ef7125dcbadbba2cb3">add()</a></code> calls should be handled. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abcf13ba52a8d43ef7125dcbadbba2cb3" name="abcf13ba52a8d43ef7125dcbadbba2cb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf13ba52a8d43ef7125dcbadbba2cb3">&#9670;&#160;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1TrieAddStatus.html">TrieAddStatus</a> kaori::AnyMismatches::add </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>barcode_seq</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">barcode_seq</td><td>Pointer to a character array containing a barcode sequence. The array should have length equal to <code><a class="el" href="#a91c7115078ceeccaeca40b5ef38c301d">length()</a></code> and should only contain IUPAC nucleotides or their lower-case equivalents (excepting U or gap characters).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The barcode sequence is added to the trie. The index of the newly added sequence is defined as the number of sequences that were previously added. The status of the addition is returned. </dd></dl>

</div>
</div>
<a id="a91c7115078ceeccaeca40b5ef38c301d" name="a91c7115078ceeccaeca40b5ef38c301d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91c7115078ceeccaeca40b5ef38c301d">&#9670;&#160;</a></span>length()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SeqLength kaori::AnyMismatches::length </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The length of the barcode sequences. </dd></dl>

</div>
</div>
<a id="a665ff85106cdd14d8f3ca6bb84feac9c" name="a665ff85106cdd14d8f3ca6bb84feac9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a665ff85106cdd14d8f3ca6bb84feac9c">&#9670;&#160;</a></span>optimize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kaori::AnyMismatches::optimize </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attempt to optimize the trie for more cache-friendly look-ups. This is not necessary if sorted sequences are supplied in <code><a class="el" href="#abcf13ba52a8d43ef7125dcbadbba2cb3">add()</a></code>. </p>

</div>
</div>
<a id="a3743e50603f631c3c266b990f0a18000" name="a3743e50603f631c3c266b990f0a18000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3743e50603f631c3c266b990f0a18000">&#9670;&#160;</a></span>search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1AnyMismatches_1_1Result.html">Result</a> kaori::AnyMismatches::search </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>search_seq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>max_mismatches</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">search_seq</td><td>Pointer to a character array containing a sequence to use for searching the barcode pool. This is assumed to be of length equal to <code><a class="el" href="#a91c7115078ceeccaeca40b5ef38c301d">length()</a></code> and is typically derived from a read. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_mismatches</td><td>Maximum number of mismatches in the search.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structkaori_1_1AnyMismatches_1_1Result.html" title="Result of the search.">Result</a> of the search, containing the index of the matching barcode and the number of mismatches to that barcode. </dd></dl>

</div>
</div>
<a id="a0b5048fb2195f0ac6f9afb8e35eb9ede" name="a0b5048fb2195f0ac6f9afb8e35eb9ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b5048fb2195f0ac6f9afb8e35eb9ede">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">BarcodeIndex kaori::AnyMismatches::size </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of barcode sequences added. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/<a class="el" href="MismatchTrie_8hpp_source.html">MismatchTrie.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
