<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::SimpleBarcodeSearch Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>kaori</b></li><li class="navelem"><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html">SimpleBarcodeSearch</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1SimpleBarcodeSearch-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::SimpleBarcodeSearch Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Search for known barcode sequences.  
 <a href="classkaori_1_1SimpleBarcodeSearch.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="BarcodeSearch_8hpp_source.html">BarcodeSearch.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html" title="State of the search.">State</a> of the search.  <a href="structkaori_1_1SimpleBarcodeSearch_1_1State.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9cd99d9aec1bb9686a75aa128e70f077"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#a9cd99d9aec1bb9686a75aa128e70f077">SimpleBarcodeSearch</a> ()</td></tr>
<tr class="separator:a9cd99d9aec1bb9686a75aa128e70f077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59fa55379464fd1ffc9fb22d54b7b86b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#a59fa55379464fd1ffc9fb22d54b7b86b">SimpleBarcodeSearch</a> (const <a class="el" href="structkaori_1_1BarcodePool.html">BarcodePool</a> &amp;barcode_pool, int max_mismatches=0, bool reverse=false, bool duplicates=false)</td></tr>
<tr class="separator:a59fa55379464fd1ffc9fb22d54b7b86b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71e5409f61bf03009046b208de7677c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#ac71e5409f61bf03009046b208de7677c">initialize</a> () const</td></tr>
<tr class="separator:ac71e5409f61bf03009046b208de7677c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac80ba1b9394963f2befe4154da98ef1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#ac80ba1b9394963f2befe4154da98ef1e">reduce</a> (<a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a> &amp;state)</td></tr>
<tr class="separator:ac80ba1b9394963f2befe4154da98ef1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e22adc910c1a0993c8932075c8dad12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#a7e22adc910c1a0993c8932075c8dad12">search</a> (const std::string &amp;search_seq, <a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a> &amp;state) const</td></tr>
<tr class="separator:a7e22adc910c1a0993c8932075c8dad12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c891331208f20f8ba1d0853a736791"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#a64c891331208f20f8ba1d0853a736791">search</a> (const std::string &amp;search_seq, <a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a> &amp;state, int allowed_mismatches) const</td></tr>
<tr class="separator:a64c891331208f20f8ba1d0853a736791"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Search for known barcode sequences. </p>
<p>This supports exact and mismatch-aware searches for known sequences. Mismatches may be distributed anywhere along the length of the sequence, see <code><a class="el" href="classkaori_1_1AnyMismatches.html" title="Search for barcodes with mismatches anywhere.">AnyMismatches</a></code> for details. Instances of this class use caching to avoid redundant work when a mismatching sequence has been previously encountered. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9cd99d9aec1bb9686a75aa128e70f077" name="a9cd99d9aec1bb9686a75aa128e70f077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cd99d9aec1bb9686a75aa128e70f077">&#9670;&#160;</a></span>SimpleBarcodeSearch() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kaori::SimpleBarcodeSearch::SimpleBarcodeSearch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default constructor. </p>

</div>
</div>
<a id="a59fa55379464fd1ffc9fb22d54b7b86b" name="a59fa55379464fd1ffc9fb22d54b7b86b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59fa55379464fd1ffc9fb22d54b7b86b">&#9670;&#160;</a></span>SimpleBarcodeSearch() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kaori::SimpleBarcodeSearch::SimpleBarcodeSearch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaori_1_1BarcodePool.html">BarcodePool</a> &amp;&#160;</td>
          <td class="paramname"><em>barcode_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_mismatches</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reverse</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>duplicates</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">barcode_pool</td><td>Pool of barcode sequences. </td></tr>
    <tr><td class="paramname">max_mismatches</td><td>Maximum number of mismatches for any search performed by this class. </td></tr>
    <tr><td class="paramname">reverse</td><td>Whether to reverse-complement the barcode sequences. </td></tr>
    <tr><td class="paramname">duplicates</td><td>Whether duplicated <code>sequences</code> in <code>barcode_pool</code> are supported, see <code><a class="el" href="classkaori_1_1MismatchTrie.html" title="Base class for the mismatch search.">MismatchTrie</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac71e5409f61bf03009046b208de7677c" name="ac71e5409f61bf03009046b208de7677c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71e5409f61bf03009046b208de7677c">&#9670;&#160;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a> kaori::SimpleBarcodeSearch::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the search state for thread-safe execution.</p>
<dl class="section return"><dt>Returns</dt><dd>A new <code>SeachState()</code>. </dd></dl>

</div>
</div>
<a id="ac80ba1b9394963f2befe4154da98ef1e" name="ac80ba1b9394963f2befe4154da98ef1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac80ba1b9394963f2befe4154da98ef1e">&#9670;&#160;</a></span>reduce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kaori::SimpleBarcodeSearch::reduce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Incorporate the mismatch cache from <code>state</code> into the cache for this <code><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html" title="Search for known barcode sequences.">SimpleBarcodeSearch</a></code> instance. This allows regular consolidation of optimizations across threads.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>A state object generated by <code><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#ac71e5409f61bf03009046b208de7677c">initialize()</a></code>. Typically this has already been used in <code><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#a7e22adc910c1a0993c8932075c8dad12">search()</a></code> at least once.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The mismatch cache of <code>state</code> is combined with that of this instance. </dd></dl>

</div>
</div>
<a id="a7e22adc910c1a0993c8932075c8dad12" name="a7e22adc910c1a0993c8932075c8dad12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e22adc910c1a0993c8932075c8dad12">&#9670;&#160;</a></span>search() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kaori::SimpleBarcodeSearch::search </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>search_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Search the known sequences in the barcode pool for an input sequence. The number of allowed mismatches is equal to the maximum specified in the constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">search_seq</td><td>The input sequence to use for searching. This is expected to have the same length as the known sequences. </td></tr>
    <tr><td class="paramname">state</td><td>A state object generated by <code><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#ac71e5409f61bf03009046b208de7677c">initialize()</a></code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>state</code> is filled with the details of the best-matching barcode sequence, if any exists. </dd></dl>

</div>
</div>
<a id="a64c891331208f20f8ba1d0853a736791" name="a64c891331208f20f8ba1d0853a736791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64c891331208f20f8ba1d0853a736791">&#9670;&#160;</a></span>search() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kaori::SimpleBarcodeSearch::search </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>search_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaori_1_1SimpleBarcodeSearch_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowed_mismatches</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Search the known sequences in the barcode pool for an input sequence, with potentially more stringent mismatch requirements. This can improve efficiency in situations where some mismatches have already been consumed by matching the template sequence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">search_seq</td><td>The input sequence to use for searching. This is expected to have the same length as the known sequences. </td></tr>
    <tr><td class="paramname">state</td><td>A state object generated by <code><a class="el" href="classkaori_1_1SimpleBarcodeSearch.html#ac71e5409f61bf03009046b208de7677c">initialize()</a></code>. </td></tr>
    <tr><td class="paramname">allowed_mismatches</td><td>Allowed number of mismatches. This should not be greater than the maximum specified in the constructor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>state</code> is filled with the details of the best-matching barcode sequence, if any exists. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/<a class="el" href="BarcodeSearch_8hpp_source.html">BarcodeSearch.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
