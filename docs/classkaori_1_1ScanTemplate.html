<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::ScanTemplate&lt; max_size_ &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacekaori.html">kaori</a></li><li class="navelem"><a class="el" href="classkaori_1_1ScanTemplate.html">ScanTemplate</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1ScanTemplate-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::ScanTemplate&lt; max_size_ &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Scan a read sequence for the template sequence.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ScanTemplate_8hpp_source.html">ScanTemplate.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1ScanTemplate_1_1State.html">State</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Details on the current match to the read sequence.  <a href="structkaori_1_1ScanTemplate_1_1State.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab5ecf53aa6a10cd565593e613939d15b" id="r_ab5ecf53aa6a10cd565593e613939d15b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5ecf53aa6a10cd565593e613939d15b">ScanTemplate</a> ()=default</td></tr>
<tr class="separator:ab5ecf53aa6a10cd565593e613939d15b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ee2e8af01383ff946bc7c84e37f93f" id="r_a16ee2e8af01383ff946bc7c84e37f93f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16ee2e8af01383ff946bc7c84e37f93f">ScanTemplate</a> (const char *template_seq, size_t template_length, SearchStrand strand)</td></tr>
<tr class="separator:a16ee2e8af01383ff946bc7c84e37f93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a7b761d5b5b82be618bd28fb9367b4" id="r_a78a7b761d5b5b82be618bd28fb9367b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1ScanTemplate_1_1State.html">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78a7b761d5b5b82be618bd28fb9367b4">initialize</a> (const char *read_seq, size_t read_length) const</td></tr>
<tr class="separator:a78a7b761d5b5b82be618bd28fb9367b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a776e42838e204cfe7842ab17b49bcfdc" id="r_a776e42838e204cfe7842ab17b49bcfdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a776e42838e204cfe7842ab17b49bcfdc">next</a> (<a class="el" href="structkaori_1_1ScanTemplate_1_1State.html">State</a> &amp;state) const</td></tr>
<tr class="separator:a776e42838e204cfe7842ab17b49bcfdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a734eb9dcee567123c1712e903a85beea" id="r_a734eb9dcee567123c1712e903a85beea"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a734eb9dcee567123c1712e903a85beea">forward_variable_regions</a> () const</td></tr>
<tr class="separator:a734eb9dcee567123c1712e903a85beea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac198b00a41a0efc014e4513a57e2c3" id="r_a2ac198b00a41a0efc014e4513a57e2c3"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ac198b00a41a0efc014e4513a57e2c3">reverse_variable_regions</a> () const</td></tr>
<tr class="separator:a2ac198b00a41a0efc014e4513a57e2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b1de0ce055b125990fe30b798554f3" id="r_aa3b1de0ce055b125990fe30b798554f3"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3b1de0ce055b125990fe30b798554f3">variable_regions</a> (bool reverse) const</td></tr>
<tr class="separator:aa3b1de0ce055b125990fe30b798554f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;size_t max_size_&gt;<br />
class kaori::ScanTemplate&lt; max_size_ &gt;</div><p>Scan a read sequence for the template sequence. </p>
<p>When searching for barcodes, <b>kaori</b> first searches for a "template sequence" in the read sequence. The template sequence contains constant regions interspersed with one or more variable regions. The template is realized into the full barcoding element by replacing each variable region with one sequence from the corresponding pool of barcodes.</p>
<p>This class will scan read sequence to find a location that matches the constant regions of the template, give or take any number of substitutions. Multiple locations on the read may match the template, provided <code><a class="el" href="#a776e42838e204cfe7842ab17b49bcfdc">next()</a></code> is called repeatedly. For efficiency, the search itself is done after converting all base sequences into a bit encoding. The maximum size of this encoding is determined at compile-time by the <code>max_length</code> template parameter.</p>
<p>Once a match is found, the sequence of the read at each variable region can be matched against a pool of known barcode sequences. See the <code><a class="el" href="classkaori_1_1BarcodePool.html" title="Pool of barcode sequences for a variable region.">BarcodePool</a></code> class for details.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">max_size_</td><td>Maximum length of the template sequence. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab5ecf53aa6a10cd565593e613939d15b" name="ab5ecf53aa6a10cd565593e613939d15b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5ecf53aa6a10cd565593e613939d15b">&#9670;&#160;</a></span>ScanTemplate() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t max_size_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1ScanTemplate.html">kaori::ScanTemplate</a>&lt; max_size_ &gt;::ScanTemplate </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default constructor. This is only provided to enable composition, the resulting object should not be used until it is copy-assigned to a properly constructed instance. </p>

</div>
</div>
<a id="a16ee2e8af01383ff946bc7c84e37f93f" name="a16ee2e8af01383ff946bc7c84e37f93f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ee2e8af01383ff946bc7c84e37f93f">&#9670;&#160;</a></span>ScanTemplate() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t max_size_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1ScanTemplate.html">kaori::ScanTemplate</a>&lt; max_size_ &gt;::ScanTemplate </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>template_seq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>template_length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SearchStrand</td>          <td class="paramname"><span class="paramname"><em>strand</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">template_seq</td><td>Pointer to a character array containing the template sequence. Constant sequences should only contain <code>A</code>, <code>C</code>, <code>G</code> or <code>T</code> (or their lower-case equivalents). Variable regions should be marked with <code>-</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">template_length</td><td>Length of the array pointed to by <code>template_seq</code>. This should be positive and less than or equal to <code>max_size_</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">strand</td><td>Strand(s) of the read sequence to search. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a734eb9dcee567123c1712e903a85beea" name="a734eb9dcee567123c1712e903a85beea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a734eb9dcee567123c1712e903a85beea">&#9670;&#160;</a></span>forward_variable_regions()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t max_size_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp; <a class="el" href="classkaori_1_1ScanTemplate.html">kaori::ScanTemplate</a>&lt; max_size_ &gt;::forward_variable_regions </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A vector of pairs where each pair specifies the start and one-past-the-end position of each variable region in the template. Coordinates are reported relative to the start of the template. Pairs are ordered by the start positions. </dd></dl>

</div>
</div>
<a id="a78a7b761d5b5b82be618bd28fb9367b4" name="a78a7b761d5b5b82be618bd28fb9367b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78a7b761d5b5b82be618bd28fb9367b4">&#9670;&#160;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t max_size_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1ScanTemplate_1_1State.html">State</a> <a class="el" href="classkaori_1_1ScanTemplate.html">kaori::ScanTemplate</a>&lt; max_size_ &gt;::initialize </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>read_seq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>read_length</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Begin a new search for the template in a read sequence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">read_seq</td><td>Pointer to an array containing the read sequence. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">read_length</td><td>Length of the read sequence.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An empty <code><a class="el" href="structkaori_1_1ScanTemplate_1_1State.html" title="Details on the current match to the read sequence.">State</a></code> object. If its <code>finished</code> member is <code>false</code>, it should be passed to <code><a class="el" href="#a776e42838e204cfe7842ab17b49bcfdc">next()</a></code> before accessing its other members. If <code>true</code>, the read sequence was too short for any match to be found. </dd></dl>

</div>
</div>
<a id="a776e42838e204cfe7842ab17b49bcfdc" name="a776e42838e204cfe7842ab17b49bcfdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776e42838e204cfe7842ab17b49bcfdc">&#9670;&#160;</a></span>next()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t max_size_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkaori_1_1ScanTemplate.html">kaori::ScanTemplate</a>&lt; max_size_ &gt;::next </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structkaori_1_1ScanTemplate_1_1State.html">State</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>state</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find the next match in the read sequence. The first invocation will search for a match at position 0; this can be repeatedly called until <code>match.finished</code> is <code>true</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>A <code><a class="el" href="structkaori_1_1ScanTemplate_1_1State.html" title="Details on the current match to the read sequence.">State</a></code> object produced by <code><a class="el" href="#a78a7b761d5b5b82be618bd28fb9367b4">initialize()</a></code>. On return, <code>state</code> is updated with the details of the current match at a particular position on the read sequence. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2ac198b00a41a0efc014e4513a57e2c3" name="a2ac198b00a41a0efc014e4513a57e2c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ac198b00a41a0efc014e4513a57e2c3">&#9670;&#160;</a></span>reverse_variable_regions()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t max_size_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp; <a class="el" href="classkaori_1_1ScanTemplate.html">kaori::ScanTemplate</a>&lt; max_size_ &gt;::reverse_variable_regions </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A vector of pairs where each pair specifies the start and one-past-the-end position of each variable region in the reverse-complented template. Coordinates are reported relative to the start of the template. Pairs are ordered by the start positions. </dd></dl>

</div>
</div>
<a id="aa3b1de0ce055b125990fe30b798554f3" name="aa3b1de0ce055b125990fe30b798554f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b1de0ce055b125990fe30b798554f3">&#9670;&#160;</a></span>variable_regions()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t max_size_&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp; <a class="el" href="classkaori_1_1ScanTemplate.html">kaori::ScanTemplate</a>&lt; max_size_ &gt;::variable_regions </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>reverse</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reverse</td><td>Whether to return variable regions on the reverse-complemented template. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Convenient alias for <code><a class="el" href="#a734eb9dcee567123c1712e903a85beea">forward_variable_regions()</a></code> or <code><a class="el" href="#a2ac198b00a41a0efc014e4513a57e2c3">reverse_variable_regions()</a></code> depending on <code>reverse</code>. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/<a class="el" href="ScanTemplate_8hpp_source.html">ScanTemplate.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
